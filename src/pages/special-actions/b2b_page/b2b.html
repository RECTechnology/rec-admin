<header-nav></header-nav>


<app-page>
  <div class="row" style="margin: 0;">
    <mat-card class="col-lg-12" style="min-height: 200px;padding: 0">
      <tl-header title="Accounts" [query]="query" [options]="headerOpts" (onSearch)="searchWrapper($event)"
        [searching]="loading">
        <button type="button" style="margin-left: 8px; padding-right: 10px; "
        color="primary" mat-raised-button name="button" (click)="openAddUserB2B()">
        <p class="text-small">
            <i class="fa fa-plus"></i>
            +{{'ADD'|translate}}
        </p>
        </button>
      </tl-header>

      <tl-subheader>
        <div style="padding: 8px 15px;">
          
           
              <mat-radio-group aria-label="Select an option" [(ngModel)]="type" (change)="changedType()">
                <mat-radio-button style="margin-right: 10px" value="" color="primary">
                  <span class="small-text">{{'All'|translate}}</span>
                </mat-radio-button>
                <mat-radio-button style="margin-right: 10px" value="pending" color="primary">
                  <span class="small-text">{{'APROVE_PENDIENTS'|translate}}</span>
                  <i style="background-color:#fcede6 ;margin-left: 10px">{{pendingCuantity}}</i>
                </mat-radio-button>
                
          </mat-radio-group>

          
        </div>
      </tl-subheader>

      <div class="wallet-transactions bg-white" style="margin-top: 0">

        <!-- Header -->
       
        
        <validation-errors [errors]="validationErrors"
          *ngIf="validationErrors.length > 0"></validation-errors>
    
        <!-- List of changes -->
        <div class="group-col-left bordered-top" style="width: 100%; position: relative;">
          <table matSort (matSortChange)="sortData($event)" class="left-align">
            <thead class="bordered-bottom stripped">
              <tr>
                <th mat-sort-header="id" style="color: #555!important">
                  {{'ID'|translate}}
                </th>
                <th mat-sort-header="name" style="color: #555!important">
                  {{'Account'|translate}}
                </th>
                <th mat-sort-header="type" style="color: #555!important">
                  {{'USERNAME'|translate}}
                </th>
                <th mat-sort-header="import" style="color: #555!important">
                  {{'USER'|translate}}
                </th>
                <th mat-sort-header="created" style="color: #555!important">
                  {{'PHONE'|translate}}
                </th>
                <th mat-sort-header="scheduled_at" style="color: #555!important">
                  {{'CIF'|translate}}
                </th>
                
                <th></th>
              </tr>
            </thead >
            <tbody *ngFor="let change of sortedData;let i = index; trackBy: trackByFn" >

                <tr onclick="viewAccount(change.id)" class="bordered-bottom" *ngIf="change.rezero_b2b_access== 'pending'" style="background-color: #fcede6;">
                    <td><code>{{change.id}}</code></td>
                    <td><b>{{change.name}}</b></td>
                    
                    <td><code>{{change.user}}</code></td>
                    <td><b>{{change.kyc_manager.dni}}</b></td>
                    <td><b>{{change.kyc_manager.phone}}</b></td>
                    <td><b>{{change.cif}}</b></td>
                    
                    <td>
                      <ng-container >
                        <button mat-icon-button [matMenuTriggerFor]="actions">
                          <span class="center h v">
                            <i class="fa fa-ellipsis-v"></i>
                          </span>
                        </button>
                        <mat-menu #actions="matMenu">
                          <button mat-menu-item >
                            <p class="small-text"><i class="fa fa-edit"></i> {{'DETAILS'|translate}}</p>
                          </button>
                          
                         
                        </mat-menu>
                      </ng-container>
    
                    </td>
                  
                  
                </tr>
                <tr class="bordered-bottom" class="bordered-bottom" *ngIf="change.rezero_b2b_access== 'granted'" style="background-color: #E0E0E0;">
                  <td><code>{{change.id}}</code></td>
                  <td><b>{{change.name}}</b></td>
                  
                  <td><code>{{change.user}}</code></td>
                  <td><b>{{change.kyc_manager.dni}}</b></td>
                  <td><b>{{change.kyc_manager.phone}}</b></td>
                  <td><b>{{change.cif}}</b></td>
                  
                  <td>
                    <ng-container >
                      <button mat-icon-button [matMenuTriggerFor]="actions">
                        <span class="center h v">
                          <i class="fa fa-ellipsis-v"></i>
                        </span>
                      </button>
                      <mat-menu #actions="matMenu">
                        <button mat-menu-item >
                          <p class="small-text"><i class="fa fa-edit"></i> {{'DETAILS'|translate}}</p>
                        </button>
                        
                       
                      </mat-menu>
                    </ng-container>
  
                  </td>
                
                
              </tr>
              <tr class="bordered-bottom" *ngIf="change.rezero_b2b_access== 'not_granted'" style="background-color: white;">
                <td><code>{{change.id}}</code></td>
                <td><b>{{change.name}}</b></td>
                
                <td><code>{{change.user}}</code></td>
                <td><b>{{change.kyc_manager.dni}}</b></td>
                <td><b>{{change.kyc_manager.phone}}</b></td>
                <td><b>{{change.cif}}</b></td>
                
                <td>
                  <ng-container  *ngIf="change.rezero_b2b_access == 'granted'" >
                    <button mat-icon-button [matMenuTriggerFor]="actions">
                      <span class="center h v">
                        <i class="fa fa-ellipsis-v"></i>
                      </span>
                    </button>
                    <mat-menu #actions="matMenu">
                      <button mat-menu-item >
                        <p class="small-text"><i class="fa fa-edit"></i> {{'DOWNGRADE_ACCES'|translate}}</p>
                      </button>
                      
                     
                    </mat-menu>
                  </ng-container>

                </td>
              
              
              </tr>
              
            </tbody>
          </table>
          <div class="center h v" style="width: 100%; padding: 15px 0" *ngIf="!sortedData.length ">
            <p class="small-text-2">{{'NO_B2B_DATA'|translate}}</p>
            <div class="center h v bg-white-opaque" style="width: 100%;height: 100px" >
              <mat-progress-spinner [diameter]="40" color="primary" mode="indeterminate" style="width: 40px; height: 40px">
              </mat-progress-spinner>
            </div>
          </div>
          
          <mat-paginator [length]="total" style="width: 100%" [pageSize]="limit" (page)="changedPage($event)"
            [pageSizeOptions]="[5, 10, 25, 100]" showFirstLastButtons>
          </mat-paginator>
        </div>
      </div>
    </mat-card>
  </div>
</app-page>